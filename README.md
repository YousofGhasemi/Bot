# ربات ثبت ورود و خروج صندوق (تلگرام)

این پروژه یک ربات تلگرامی ساده و دقیق است که به شما کمک می‌کند **ورود و خروج دارایی‌ها** (مثل دلار یا سکه) را در یک گروه تلگرام ثبت و مدیریت کنید.  
ربات به صورت خودکار پیام‌های گروه را تحلیل کرده و موجودی لحظه‌ای را به‌روز می‌کند.

---

## ✨ قابلیت‌ها
- **تحلیل خودکار پیام‌ها**: بدون نیاز به کاراکتر خاص، هر پیام مطابق الگوی مشخص‌شده پردازش می‌شود.
- **پشتیبانی از اعداد فارسی و انگلیسی** (به‌صورت عددی یا کلمه‌ای مانند "پنج").
- **ضریب معامله**: واژه‌ی «عدد» = ۱ و «تا» = ۱۰۰۰ (با استثنا برای سکه‌های امامی، نیم، ربع، تمام).
- **ورود/خروج**: یک حرف `و` (ورود) یا `خ` (خروج).
- **طرف حساب**: هر متنی بعد از حرف ورود/خروج.
- **موجودی لحظه‌ای**: بات پس از هر پیام، موجودی همان دارایی را بازنویسی می‌کند.
- **دکمه اینلاین** برای دریافت موجودی کلی.
- **ویرایش پیام‌ها**: اگر کاربر پیام را ویرایش کند، موجودی اصلاح می‌شود.
- **گزارش جدولی**: نمایش مجموع ورودها و خروج‌ها برای هر دارایی.
- **حذف پیام‌ها**: در حالت عادی Bot API پشتیبانی نمی‌کند. برای پشتیبانی از حذف پیام‌ها می‌توانید از [Telethon](https://docs.telethon.dev) به‌صورت اختیاری استفاده کنید.

---

## 🛠️ پیش‌نیازها
- پایتون 3.8+
- یک توکن بات از [BotFather](https://t.me/BotFather)
- کتابخانه‌های پایتون (در `requirements.txt` آمده است)

---

## 📦 نصب و راه‌اندازی
1. ریپازیتوری را کلون کنید:
```
   git clone https://github.com/your-username/telegram-fund-bot.git
   cd telegram-fund-bot
```
2.محیط مجازی بسازید و پکیج‌ها را نصب کنید:
```
    python -m venv venv
    source venv/bin/activate   # در ویندوز: venv\Scripts\activate
    pip install -r requirements.txt
```
3.فایل config.py را باز کنید و توکن بات (BOT_TOKEN) را وارد کنید.

4. بات را اجرا کنید:
```
python bot.py
```
ساختار پروژه
```
.
├── bot.py          # منطق اصلی ربات (هندلرها، اتصال به تلگرام)
├── parser.py       # پارسر پیام‌ها و استخراج داده‌ها
├── db.py           # مدیریت دیتابیس (JSON سبک و دقیق)
├── config.py       # تنظیمات و پیکربندی
├── requirements.txt# وابستگی‌ها
└── README.md       # راهنما (همین فایل)

```
📊 فرمت پیام‌ها

الگوی پیام‌ها:

مقدار معامله: عدد (مثلاً 5 یا پنج)

ضریب معامله: عدد = ۱ ، تا = ۱۰۰۰
(استثنا: برای دارایی‌های «امامی، نیم، ربع، تمام» → تا = ۱)

اسم دارایی: کلمه(ها) بین ضریب و متغیر ورود/خروج

ورود/خروج: یک حرف و یا خ

طرف حساب: متن بعد از ورود/خروج

نمونه‌ها:

5 تا دلار استرالیا خ نظیر رحیمی → خروج ۵۰۰۰ دلار استرالیا به نظیر رحیمی

پنج تا امامی خ علی → خروج ۵ عدد سکه امامی به علی

27 تا و رضایی → ورود ۲۷۰۰۰ دلار از رضایی

📈 گزارش‌دهی

ربات با دستور /balance یا دکمه‌ی اینلاین، گزارشی به شکل زیر ارائه می‌دهد:

دلار
ورود: 30,000    خروج: 2,350

امامی
ورود: 0         خروج: 5


🚨 نکته مهم درباره حذف پیام

API رسمی بات تلگرام حذف پیام‌ها را ارسال نمی‌کند.

برای پشتیبانی از حذف پیام‌ها باید ماژول Telethon (userbot) را فعال کنید:

در config.py مقدار TELETHON_ENABLE = True بگذارید.

TELETHON_API_ID و TELETHON_API_HASH را از my.telegram.org
 دریافت کنید.

هنگام اولین اجرا، شماره تلفن و کد تأیید را وارد کنید.



🤝 مشارکت

خوشحال می‌شویم در صورت مشاهده‌ی باگ یا نیاز به ویژگی جدید، Issue یا Pull Request ایجاد کنید.